<#include "/lib/layout.html">
<#include "/extension/svnexplorer/lib/revision.html" >

<@layout_std
    page="svnexplorer-issue"
    title=info.issue.key
    style=true
    noscript=true
    extension=true
    breadcrumbs={loc("home"):""}>

    <div class="row-fluid">
        <div class="span12 page-title">
                <span class="title">
                    <a href="${info.issue.url?html}">${info.issue.key?html}</a>
                    <span class="description">
                        @
                        ${info.repository.name}
                    </span>
                </span>
                <span class="action action-optional">
                    <a href=""><i class="icon-remove"></i> <@lh key="general.close" /></a>
                </span>
        </div>
    </div>

    <!-- TODO Use jira-issue.html for #293 -->

    <div class="row-fluid">
        <div class="span12">
            <table>
                <tbody>
                    <tr>
                        <td class="issue-info-label"><@lh key="jira.issue.status" /></td>
                        <td class="issue-info-value">
                            <img src="${info.issue.status.iconUrl?html}" />
                            ${info.issue.status.name?html}
                        </td>
                    </tr>
                    <tr>
                        <td class="issue-info-label"><@lh key="jira.issue.summary" /></td>
                        <td class="issue-info-value">${info.issue.summary?html}</td>
                    </tr>
                    <tr>
                        <td class="issue-info-label"><@lh key="jira.issue.affectedVersions" /></td>
                        <td class="issue-info-value">
                            <ul class="version">
                                <#list info.issue.affectedVersions as version>
                                    <li>
                                        <span class="separator">, </span>
                                        ${version.name}
                                    </li>
                                </#list>
                            </ul>
                        </td>
                    </tr>
                    <tr>
                        <td class="issue-info-label"><@lh key="jira.issue.fixVersions" /></td>
                        <td class="issue-info-value">
                            <ul class="version">
                                <#list info.issue.fixVersions as version>
                                    <li>
                                        <span class="separator">, </span>
                                        ${version.name}
                                    </li>
                                </#list>
                            </ul>
                        </td>
                    </tr>
                    <tr>
                        <td class="issue-info-label"><@lh key="jira.issue.assignee" /></td>
                        <td class="issue-info-value">${info.issue.assignee?html}</td>
                    </tr>
                    <tr>
                        <td class="issue-info-label"><@lh key="jira.issue.updateTime" /></td>
                        <td class="issue-info-value">${info.formattedUpdateTime?html}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <@revision_info_summary info = info.revisionInfo title = true />

    <@revision_info_builds info = info.revisionInfo mergedInfos = info.mergedRevisionInfos />

    <@revision_info_promotions info = info.revisionInfo mergedInfos = info.mergedRevisionInfos />


    <div class="row-fluid">
        <div class="span12">
            <h1><small><@lh key="svnexplorer.issue.revisions" /></small></h1>
            <table class="table table-condensed table-hover">
                <thead>
                    <tr>
                        <th><@lh key="svnexplorer.changelog.revisions.revision" /></th>
                        <th><@lh key="svnexplorer.changelog.revisions.author" /></th>
                        <th><@lh key="svnexplorer.changelog.revisions.date" /></th>
                        <th><@lh key="svnexplorer.changelog.revisions.message" /></th>
                    </tr>
                </thead>
                <tbody>
                    <#list info.revisions as revision>
                        <tr>
                            <td>
                                <a href="${revision.revisionUrl?html}">${revision.revision?c}</a>
                                <a href="gui/extension/svnexplorer/revision/${revision.revision?c}"><i class="icon-info-sign"></i></a>
                            </td>
                            <td>${revision.author?html}</td>
                            <td>${revision.isoDateTime?html}</td>
                            <td>${revision.formattedMessage}</td>
                        </tr>
                    </#list>
                </tbody>
            </table>
        </div>
    </div>

</@layout_std>